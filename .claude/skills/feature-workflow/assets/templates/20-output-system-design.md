# Step 2: 시스템 설계 결과

## 1. 설계 요약

| 항목               | 내용                         |
| ------------------ | ---------------------------- |
| **핵심 설계 결정** | [1문장 요약]                 |
| **영향 범위**      | 신규 파일 N개, 수정 파일 M개 |
| **예상 복잡도**    | Low / Medium / High          |

## 2. Step 1 입력 확인

> Step 1 분석 결과가 설계에 반영되었는지 확인합니다.

### 2.1 기술적 결정 사항 반영

| Step 1 결정                  | 설계 반영 위치  | 비고 |
| ---------------------------- | --------------- | ---- |
| [예: 상태 관리 - Zustand]    | 3.2 상태 설계   |      |
| [예: API 호출 - React Query] | 3.3 데이터 흐름 |      |

### 2.2 갭 분석 대응

| Step 1 갭                  | 설계 대응                   | 담당             |
| -------------------------- | --------------------------- | ---------------- |
| [Figma: 에러 상태 UI 없음] | ErrorBoundary 컴포넌트 추가 | 개발팀 자체 결정 |
| [API: 에러 응답 미정의]    | 공통 에러 핸들러로 처리     | 백엔드 확인 필요 |

## 3. 아키텍처 설계

### 3.1 디렉토리 구조

```
src/
├── features/[feature-name]/
│   ├── components/
│   │   ├── [Component].tsx      # UI 컴포넌트
│   │   └── [Component].test.tsx # 컴포넌트 테스트
│   ├── hooks/
│   │   └── use[Feature].ts      # 비즈니스 로직
│   ├── api/
│   │   └── [feature].api.ts     # API 호출
│   └── types/
│       └── [feature].types.ts   # 타입 정의
```

### 3.2 화면-컴포넌트 매핑

| Figma 화면 | 컴포넌트         | 상태                    | API 연동        |
| ---------- | ---------------- | ----------------------- | --------------- |
| [화면명]   | `<ComponentA />` | loading, success, error | `GET /api/xxx`  |
| [화면명]   | `<ComponentB />` | idle, submitting        | `POST /api/xxx` |

### 3.3 데이터 흐름

```
[사용자 액션] → [Hook] → [API 호출] → [상태 업데이트] → [UI 렌더링]
```

### 3.4 인터페이스 정의

```typescript
// types/[feature].types.ts

/** API 응답 타입 (Swagger 기반) */
interface ApiResponse {
  // Swagger 스펙에서 추출
}

/** 컴포넌트 Props */
interface ComponentProps {
  // 필요한 props 정의
}

/** 상태 타입 */
interface FeatureState {
  // 상태 구조 정의
}
```

## 4. 테스트 전략 (TDD)

> Step 1의 테스트 시나리오(TS-xxx)를 구현 전략으로 변환합니다.

### 4.1 테스트 경계

| 레벨        | 범위                         | 도구                 | 커버리지 목표 |
| ----------- | ---------------------------- | -------------------- | ------------- |
| Unit        | 비즈니스 로직 (hooks, utils) | Vitest               | [목표]%       |
| Integration | 컴포넌트 + Hook              | Testing Library      | 주요 플로우   |
| E2E         | 전체 사용자 시나리오         | Playwright / Cypress | P0 시나리오   |

### 4.2 Mock 전략

| 대상         | Mock 방식               | 이유                      |
| ------------ | ----------------------- | ------------------------- |
| API 호출     | MSW                     | 실제 응답 구조 시뮬레이션 |
| 외부 서비스  | vi.mock() / jest.mock() | 의존성 격리               |
| 브라우저 API | polyfill / mock         | 테스트 환경 호환성        |

### 4.3 테스트 시나리오 → 테스트 파일 매핑

| Step 1 시나리오 | 테스트 파일                   | 테스트 유형 |
| --------------- | ----------------------------- | ----------- |
| TS-001          | `hooks/useFeature.test.ts`    | Unit        |
| TS-002          | `components/Feature.test.tsx` | Integration |
| TS-101          | `api/feature.api.test.ts`     | Unit (MSW)  |
| TS-102          | `api/feature.api.test.ts`     | Unit (MSW)  |

## 5. 파일별 구현 계획

> LLM이 구현할 파일 목록과 순서입니다. 의존성 순서대로 구현합니다.

### 5.1 신규 생성 파일

| 순서 | 파일                       | 역할          | 의존성       | 관련 TS        |
| ---- | -------------------------- | ------------- | ------------ | -------------- |
| 1    | `types/[feature].types.ts` | 타입 정의     | 없음         | -              |
| 2    | `api/[feature].api.ts`     | API 호출      | types        | TS-101, TS-102 |
| 3    | `hooks/use[Feature].ts`    | 비즈니스 로직 | api, types   | TS-001, TS-002 |
| 4    | `components/[Feature].tsx` | UI 컴포넌트   | hooks, types | -              |
| 5    | `__tests__/*.test.ts`      | 테스트        | 전체         | 모든 TS-xxx    |

### 5.2 수정 필요 파일

| 파일                   | 수정 내용       | 영향 범위 |
| ---------------------- | --------------- | --------- |
| [예: routes/index.tsx] | 라우트 추가     | Low       |
| [예: api/client.ts]    | 엔드포인트 추가 | Low       |

## 6. 코드 패턴 가이드

> LLM이 참조할 기존 코드 패턴입니다.

### 6.1 따라야 할 패턴

**Hook 패턴:**

```typescript
// 참조: src/features/[existing]/hooks/use[Existing].ts
// 이 패턴을 따라 구현하세요
```

**컴포넌트 패턴:**

```typescript
// 참조: src/features/[existing]/components/[Existing].tsx
// 이 패턴을 따라 구현하세요
```

**API 호출 패턴:**

```typescript
// 참조: src/features/[existing]/api/[existing].api.ts
// 이 패턴을 따라 구현하세요
```

### 6.2 금지 사항

- [ ] `any` 타입 사용 금지
- [ ] 인라인 스타일 금지 (CSS-in-JS / Tailwind 사용)
- [ ] `console.log` 커밋 금지
- [ ] 하드코딩된 문자열 금지 (상수/i18n 사용)
- [ ] [프로젝트 특화 규칙 추가]

## 7. 리뷰 체크포인트

> 사람 리뷰어가 확인할 항목입니다.

### 7.1 설계 검증 (Step 2 완료 시)

- [ ] Step 1 요구사항이 모두 반영되었는가?
- [ ] 기존 아키텍처와 일관성이 있는가?
- [ ] 테스트 전략이 TDD 원칙에 맞는가?
- [ ] 파일 구조가 프로젝트 컨벤션을 따르는가?

### 7.2 구현 검증 (Step 3 완료 후)

- [ ] 모든 TS-xxx 테스트가 통과하는가?
- [ ] 6.1 코드 패턴을 따랐는가?
- [ ] 6.2 금지 사항을 위반하지 않았는가?
- [ ] 5.1 순서대로 구현되었는가?

## 8. 기술적 위험 및 대응

| 위험 요소           | 영향도 | 발생 가능성 | 대응 방안   |
| ------------------- | ------ | ----------- | ----------- |
| [예: 기존 API 변경] | High   | Medium      | [대응 방안] |
| [예: 성능 병목]     | Medium | Low         | [대응 방안] |

## 9. 미결 사항

| #   | 항목   | 결정 필요 사항   | 담당     | 상태 |
| --- | ------ | ---------------- | -------- | ---- |
| 1   | [항목] | [결정 필요 내용] | [담당자] | Open |

## 10. 다음 단계

**Step 3 (구현)에서 주의사항:**

- [ ] 5.1 순서대로 구현 (의존성 순서 준수)
- [ ] 각 파일 구현 시 해당 테스트 먼저 작성 (TDD)
- [ ] 6.1 패턴 참조하여 일관성 유지
- [ ] 구현 완료 후 7.2 체크리스트로 자가 검증
